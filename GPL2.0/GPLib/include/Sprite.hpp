#pragma once

#include <SFML/Graphics.hpp>

#include <string>
#include <vector>
#include <iostream>
#include "Object.hpp"
#include "Panel.hpp"
#include "Base.hpp"
//#include "../include/gpl.hpp"



class Sprite : public Object
{
private:
	//Panel* panel;
	//Base* base;
	int x;
	int y;
	int alpha;
	bool mirror;
	unsigned int angle;
	unsigned int animationTime;
	sf::Time timer;
	sf::Clock clk;
    int currentFrame;

	std::vector<sf::Texture*> frames;
	sf::Sprite _sprite;
public:

	////////////////////////////////////////////////////////////////////////////////////////////////////
	/// <summary>	Cria o sprite <see cref="Sprite"/>. </summary>
	////////////////////////////////////////////////////////////////////////////////////////////////////
	Sprite(void);

	////////////////////////////////////////////////////////////////////////////////////////////////////
	/// <summary>	Deleta o sprite <see cref="Sprite"/>. </summary>
	////////////////////////////////////////////////////////////////////////////////////////////////////
	~Sprite(void);

	////////////////////////////////////////////////////////////////////////////////////////////////////
	/// <summary>	Carrega arquivo de sprite </summary>
	/// <param name="filename">	Caminho do arquivo da sprite a ser carregado (bmp, png, tga, jpg, gif, psd, hdr, pic)</param>
	////////////////////////////////////////////////////////////////////////////////////////////////////
	void load(std::string filename);
	
	////////////////////////////////////////////////////////////////////////////////////////////////////
	/// <summary>
	/// Carrega parte de um arquivo de sprite
	/// </summary>
	/// <param name="filename">	Caminho do arquivo da sprite a ser carregado (bmp, png, tga, jpg, gif, psd, hdr, pic)</param>
	/// <param name="x">	   	Posição X de inicio do recorte. </param>
	/// <param name="y">	   	Posição Y de inicio do recorte. </param>
	/// <param name="width">   	Largura do recorte. </param>
	/// <param name="height">  	Altura do recorte. </param>
	////////////////////////////////////////////////////////////////////////////////////////////////////
	void load(std::string filename, unsigned int x, unsigned int y, unsigned int width, unsigned int height);

	////////////////////////////////////////////////////////////////////////////////////////////////////
	/// <summary>
	/// Define a velocidade da animação, ou seja, o tempo que cada frame será exibido, padrão e 30.
	/// </summary>
	/// <param name="speed">	velocidade dos frames. </param>
	////////////////////////////////////////////////////////////////////////////////////////////////////
	void setSpeed(unsigned int speed);

	////////////////////////////////////////////////////////////////////////////////////////////////////
	/// <summary> Retorna a velocidade da animação, se não alterado o valor padrão é 30 </summary>
	////////////////////////////////////////////////////////////////////////////////////////////////////
	int getSpeed() const;

	////////////////////////////////////////////////////////////////////////////////////////////////////
	/// <summary>	Retorna a largura do sprite</summary>
	////////////////////////////////////////////////////////////////////////////////////////////////////
	int getResX() const;

	////////////////////////////////////////////////////////////////////////////////////////////////////
	/// <summary>	Retorna a altura do sprite</summary>
	////////////////////////////////////////////////////////////////////////////////////////////////////
	int getResY() const;

	////////////////////////////////////////////////////////////////////////////////////////////////////
	/// <summary>	Desenha o sprite. </summary>	///
	/// <param name="pos">	 	Posição X e Y. </param>
	/// <param name="scale">	(Optional) Escala X e Y </param>
	/// <param name="alpha"> 	(Optional) Transparência </param>
	/// <param name="angle"> 	(Optional) (Opcional) angulo, padrão é 0. </param>
	/// <param name="edge">  	(Optional) (Opcional) desenhar borda no sprite, padrão é não. </param>
	////////////////////////////////////////////////////////////////////////////////////////////////////
	void draw(Vector2 pos, Vector2 scale = Vector2(1.0, 1.0), unsigned int alpha = 255, unsigned int angle = 0, bool edge = false);

	////////////////////////////////////////////////////////////////////////////////////////////////////
	/// <summary>	Desenha o sprite. </summary>	///
	/// <param name="x">	 	Posição X. </param>
	/// <param name="y">	 	Posição Y. </param>
	/// <param name="mirror">	(Optional) Espelhamento </param>
	/// <param name="alpha"> 	(Optional) Transparência </param>
	/// <param name="angle"> 	(Optional) (Opcional) angulo, padrão é 0. </param>
	/// <param name="edge">  	(Optional) (Opcional) desenhar borda no sprite, padrão é não. </param>
	////////////////////////////////////////////////////////////////////////////////////////////////////

	void draw(int x, int y, bool mirror = false, unsigned int alpha = 255, unsigned int angle = 0, bool edge = false);

	////////////////////////////////////////////////////////////////////////////////////////////////////
	/// <summary>	Sets a frame. </summary>
	///
	/// <remarks>	Nesi, 03/09/2014. </remarks>
	///
	/// <param name="frame">	The frame. </param>
	////////////////////////////////////////////////////////////////////////////////////////////////////
	void setFrame(int frame);

	////////////////////////////////////////////////////////////////////////////////////////////////////
	/// <summary>	Gets the current frame. </summary>
	///
	/// <remarks>	Nesi, 19/02/2016. </remarks>
	////////////////////////////////////////////////////////////////////////////////////////////////////
	int Sprite::getFrame();

	////////////////////////////////////////////////////////////////////////////////////////////////////
	/// <summary>	Verifica se o sprite colidiu com outro sprite. </summary>
	///
	///
	/// <param name="_sprite">	Sprite a ser verificada se houve colisão. </param>
	///
	/// <returns> se houve colisão retorna true, caso contrário retorna falso</returns>
	////////////////////////////////////////////////////////////////////////////////////////////////////
	bool collides(Sprite _sprite);

	////////////////////////////////////////////////////////////////////////////////////////////////////
	/// <summary>	Retorna a posição do sprite no eixo X. </summary>
	////////////////////////////////////////////////////////////////////////////////////////////////////
	int getPosX() const;

	////////////////////////////////////////////////////////////////////////////////////////////////////
	/// <summary>	Retorna a posição do sprite no eixo Y. </summary>
	////////////////////////////////////////////////////////////////////////////////////////////////////
	int getPosY() const;
};